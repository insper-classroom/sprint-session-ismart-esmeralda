{% extends "atendimento/base.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'atendimento/style/estatisticas.css' %}">

<header>
    <div class="imagens-header">
        <div class="img-cima">
            <div class="img1">
                <button onclick="window.location.href = '/side_nao_atribuido/'" style="cursor: pointer;" >
                    <img src="{% static 'atendimento/img/inbox-solid.svg' %}" alt="Logo 1">
                </button>
            </div>
            <div class="img2">
                <a href="/side_nao_atribuido/" style="cursor: pointer;">
                    <img src="{% static 'atendimento/img/house-solid.svg' %}" alt="Logo 2">
                </a>
            </div>
            <div class="img3">
                <button>
                    <img src="{% static 'atendimento/img/chart.svg' %}" alt="Logo 3">
                </button>
            </div>
        </div>
    </div>
</header>

<div class="main">
    <div class="top-header">
        <p class="titulo-top">ESTATÍSTICAS</p>
    </div>

    <div class="container">
        <div class="formacontainer">
            <h2>Sumário da Atividade</h2><hr />
            <div class="itens">
                <div class="container-item item1">
                    <p>Na fila</p>
                    <p class="valor">{{notassigned|length}}</p>
                </div><div class="vl"></div>
                <div class="container-item">
                    <p>Tempo médio para resposta</p>
                    <p class="valor">{{stats.average_response_time}}</p><div class="hl"></div>
                    <p class="obs">Nas últimas 24h</p>
                </div><div class="vl"></div>
                <div class="container-item item3">
                    <p>Casos resolvidos</p>
                    <p class="valor">{{stats.totalresolvidos}}</p><div class="hl"></div>
                    <p class="obs">Nas últimas 24h</p>
                </div>
            </div>
        </div>

        <div class="formacontainer">
            <h2>Atendimentos</h2><hr />
            <div class="itens">
                <div class="container-item item1">
                    <p>Atendimentos automatizados</p>
                    <p class="valor">33%</p>
                </div><div class="vl"></div>
                <div class="container-item">
                    <p>Quantidade de atendimentos</p>
                    <p class="valor">1h 45min</p><div class="hl"></div>
                    <p class="obs">Nas últimas 24h</p>
                </div><div class="vl"></div>
                <div class="container-item item3">
                    <p>Usuários satisfeitos</p>
                    <p class="valor">20 de 35</p><div class="hl"></div>
                    <p class="obs">Nas últimas 24h</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function checkMail(){
        fetch('/receive_email/')
            .then(response => response.json())
            .then(
                data => {console.log('email recebido')}
            )
            .catch(error => console.log('chegou nenhum email', error));
    }

    checkMail();
    setInterval(checkMail, 15000);
</script>
<script>
    function updateResolved(){
        fetch('/checar_tempo/')
            .then(response => response.json())
            .then(
                data => {console.log('tarefa resolvida')}
            )
            .catch(error => console.log('alguma coisa deu rum ai pae'))
        }

    updateResolved();
    setInterval(updateResolved, 15000);
</script>

{% endblock %}
